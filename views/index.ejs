<!DOCTYPE html>
<html lang="en">
  <%- include("./partials/head.ejs") %>
  <style>
    body {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
  </style>
  <body>
    <%- include("./partials/nav.ejs") %>
    <div class="top-container">
      <div class="search-container">
        <!-- <div class="search-box">
          <input type="text" placeholder="search" id="search-field" />
        </div> -->
        <div class="manual-entry-form-container">
          <form action="/index" method="post" class="enter-place">
            <label>City:<input type="text" name="city" id="form-city" /></label>
            <label>Country: <input type="text" name="country" id="form-country" /></label>
            <label>Photo: <input type="url" name="photo_url" id="form-photo_url" /></label>
            <label
              >Status
              <select name="status" id="custom-search">
                <option value="Visited">Visited</option>
                <option value="Going">Going</option>
                <option value="Want to go">Want to go</option>
              </select>
            </label>
            <label>Date<input type="date" name="date" /></label>
            <!-- <label>Travel Notes:<input type="text" name="notes" id="form-notes" /></label> -->
            <button class="manual-entry-submit-button">Submit</button>
          </form>
        </div>
        <div class="search-results-container">
          <div class="search-results-div"></div>
        </div>
      </div>
      <div class="collection-container">
        <% for (i=allCities.length-1; i>=0; i--) { %>

        <div class="collection-item">
          <div class="city-photo">
            <img src="<%= allCities[i].photo_url %>" alt="" />
          </div>
          <div class="city-action-container">
            <div class="action-block">
              <a href="/index/<%= allCities[i]._id %>">
                <div class="city-name-container">
                  <div class="city-full-name"><%= allCities[i].city %>, <%= allCities[i].country %></div>
                </div>
              </a>

              <div class="location-stats">
                <table class="location-stats-table">
                  <!-- <tr>
                    <td>Population</td>
                    <td><%= // allCities[i].population %></td>
                  </tr> -->
                  <tr>
                    <td>Status</td>
                    <td><%= allCities[i].status %></td>
                  </tr>
                  <tr>
                    <td>Date</td>
                    <td><%= allCities[i].date %></td>
                  </tr>
                </table>
              </div>

              <div class="buttons-container">
                <a href="/index/<%= allCities[i]._id %>/edit" class="edit-button"> Edit </a>
                <div class="delete-button">
                  <form class="index-form" action="/index/<%=allCities[i]._id %>?_method=DELETE" method="post">
                    <input type="submit" value="Delete" id="delete-location" />
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>

        <% } %>
      </div>
    </div>
  </body>
  <%- include("./partials/footer.ejs") %>
  <script>
    function checkUserLogin() {
      const $userName = $("#user-name");
      console.log($userName.html());
      if ($userName.html() === "") {
        console.log(`no user`);
        $(".hello-user").addClass("hidden");
        $(".log-out").addClass("hidden");
      } else {
        console.log(`user is: ${$userName}`);
        $(".sign-up").addClass("hidden");
        $(".log-in").addClass("hidden");
      }
    }

    async function runTest() {
      console.log($userName.html());
      console.log("function test");
      console.log($(".site-title").html());
    }

    checkUserLogin();
  </script>
</html>
